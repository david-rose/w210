<!DOCTYPE html>
<html lang="en">
  <head>
    <script src="./js/d3.min.js" charset="utf-8"></script>
    <script src="./data/data-api.js" ></script>
    <meta charset="utf-8">
    <title>Crisis ID Data Query Test</title>
    <style>
     body {
       font: 11px sans-serif;
     }
     .code {
       float: left;
       width: 17%;
       margin-left:0px;
       margin-right:0px;
       padding-left:0px;
       padding-right:0px;
       word-wrap: normal;
     }
     .codemiddle {
       float: left;
       width: 30%;
       margin-left:0px;
       margin-right:0px;
       padding-left:0px;
       padding-right:0px;
       word-wrap: break-word;
       border-left: thin solid #000000;
       border-right: thin solid #000000;
     }
    </style>
  </head>
  <body>
     <div class="options">
    <span>Topic 
      <select id="topic" onChange="updatedata()" >
        <option value="all" selected >All</option>
        <option value="mersc" >MERS</option>
        <option value="moldf" >MOLDF</option>
        <option value="chole" >Cholera</option>
        <option value="swine" >Swine Flu</option>
        <option value="hepat" >Hepatitis</option>
        <option value="influ" >Influenza</option>
        <option value="plagu" >Plague</option>
        <option value="westn" >West Nile</option>
        <option value="dengu" >Dengue</option>
        <option value="measl" >Measles</option>
        <option value="pertu" >Pertussis</option>
        <option value="hemmo" >Hemorrhagic Fever</option>
        <option value="menin" >Meningitis</option>
        <option value="ebola" >Ebola</option>
        <option value="mumps" >Mumps</option>
        <option value="chiku" >Chikungunya</option>
        <option value="yello" >Yellow Fever</option>
        <option value="unkno" >Unknown</option>
      </select>
    </span>

    <span>Date
      <select id="date" >
        <option value="2015-09-30" selected>2015-09-30</option>
      </select>
    </span>
    <br/>
    <hr/>
  </div>

    <div class="code" id="articles" ></div>
    <div class="display" id="viz" ></div>

    <script>
     var articles = {};
     var aggregates = {};
     window.onload = function() {articles = loadarticles(); }
     console.log("q1.html: articles count = " + articles.length);
//     window.onload = function() {articles = loadarticles(); aggregates = loadarticlesagg(); updatedata(); }

     function updatedata()
     {
       var topic = document.getElementById("topic").value;
       var enddate = document.getElementById("date").value;

       topic = "all";
       enddate = "2015-09-30";

       var articlelist = getarticlelist(topic, enddate, 10);

       displayJSON(articlelist, 'Articles', 'articles');
     }

     function displayJSON(o, label, id)
     {
       var s = "";
       o.forEach(function(item, index, array)
         {
           s = s + JSON.stringify(item, null, '  ') + "\n";
         });
       s = "<hr/><br/><strong>" + label + "</strong><br/><hr/>" + "<pre>" + s;
       s = s + "</pre>" + "<hr/>";
       document.getElementById(id).innerHTML = s;
     }
    </script>

  </body>
</html>
